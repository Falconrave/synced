/* Facebook Connect helper crap (mostly because GWT + Facebook Connect == Fail). */
window.FB_WithInit = function(callback) {
  FB_RequireFeatures(["Api", "Connect", "XFBML"], function() {
    FB.init("@FB_API_KEY@", "/fbconnect.html");
  });
  window.FB_WithInit = FB.Bootstrap.ensureInit;
  FB_WithInit(function() {
    callback();
  });
};
window.FB_RequireSession = function() {
  FB_WithInit(function() {
    FB.Connect.requireSession(function() {
      FB_RequireSessionCallback(FB.Facebook.apiClient.get_session().uid);
      FB_RequireSessionCallback = null;
    });
  });
};
window.FB_PostStory = function(bundleId, data, targetIds, body) {
  FB_WithInit(function() {
    FB.Connect.showFeedDialog(bundleId, data, targetIds, body, null,
                              FB.RequireConnect.promptConnect, function () { /*noop*/ });
  });
};
window.FB_PostTrophy = function(templateId, data) {
  FB_PostStory(templateId, data, [], "");
};
window.FB_Logout = function() {
  FB_WithInit(function() {
    FB.Connect.logout(null);
  });
};
window.FB_ParseXFBML = function () {
  FB_WithInit(function() {
    FB.XFBML.Host.parseDomTree();
  });
}
